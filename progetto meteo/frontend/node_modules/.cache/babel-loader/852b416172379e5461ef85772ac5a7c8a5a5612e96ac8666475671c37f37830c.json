{"ast":null,"code":"import { mapGetters } from 'vuex';\nexport default {\n  name: \"WeatherView\",\n  data() {\n    return {\n      city: '',\n      loading: false,\n      error: ''\n    };\n  },\n  computed: {\n    ...mapGetters(['weatherData'])\n  },\n  methods: {\n    async fetchWeather() {\n      this.error = '';\n      this.loading = true;\n      try {\n        await this.$store.dispatch('fetchNewWeatherData', this.city);\n        await this.$store.dispatch('fetchWeatherData');\n      } catch (err) {\n        this.error = err.response?.data?.message || 'Errore durante il recupero dei dati meteo.';\n      } finally {\n        this.loading = false;\n      }\n    },\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      return date.toLocaleString();\n    },\n    rowStyle(item) {\n      // Cambia colore riga in base alla condizione meteo\n      if (!item.description) return {};\n      const desc = item.description.toLowerCase();\n      if (desc.includes('rain')) return {\n        background: '#e3f0fa'\n      };\n      if (desc.includes('clear')) return {\n        background: '#fffbe6'\n      };\n      if (desc.includes('cloud')) return {\n        background: '#f0f4f7'\n      };\n      if (desc.includes('snow')) return {\n        background: '#f8fafd'\n      };\n      return {};\n    }\n  },\n  mounted() {\n    if (this.weatherData.length === 0) {\n      this.$store.dispatch('fetchWeatherData').catch(() => {});\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","name","data","city","loading","error","computed","methods","fetchWeather","$store","dispatch","err","response","message","formatDate","dateStr","date","Date","toLocaleString","rowStyle","item","description","desc","toLowerCase","includes","background","mounted","weatherData","length","catch"],"sources":["C:\\Users\\Giovanni\\OneDrive\\Desktop\\Scuola\\TPI\\progetto meteo\\frontend\\src\\views\\WeatherView.vue"],"sourcesContent":["<template>\r\n  <div class=\"weather-view container mt-5\">\r\n    <h2>Meteo</h2>\r\n    <form class=\"row g-3 mb-4\" @submit.prevent=\"fetchWeather\">\r\n      <div class=\"col-auto\">\r\n        <input v-model=\"city\" type=\"text\" class=\"form-control\" placeholder=\"Inserisci una città\" required />\r\n      </div>\r\n      <div class=\"col-auto\">\r\n        <button type=\"submit\" class=\"btn btn-primary\">Cerca Meteo</button>\r\n      </div>\r\n    </form>\r\n    <div v-if=\"error\" class=\"alert alert-danger\">{{ error }}</div>\r\n    <div v-if=\"loading\" class=\"alert alert-info\">Caricamento...</div>\r\n    <div v-if=\"weatherData.length === 0 && !loading && !error\" class=\"alert alert-secondary\">\r\n      Nessun dato meteo disponibile. Cerca una città per visualizzare i dati.\r\n    </div>\r\n    <table v-if=\"weatherData.length > 0\" class=\"table table-striped mt-4\">\r\n      <thead>\r\n        <tr>\r\n          <th>Città</th>\r\n          <th>Temperatura</th>\r\n          <th>Condizione</th>\r\n          <th>Data ricerca</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"(item, idx) in weatherData\" :key=\"idx\" :style=\"rowStyle(item)\">\r\n          <td>{{ item.city }}</td>\r\n          <td>{{ item.temperature }} °C</td>\r\n          <td>\r\n            <img v-if=\"item.icon\" :src=\"item.icon\" :alt=\"item.description\" style=\"height:32px;vertical-align:middle;margin-right:8px;\">\r\n            {{ item.description }}\r\n          </td>\r\n          <td>{{ formatDate(item.fetchDate || item.createdAt || item.date) }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  name: \"WeatherView\",\r\n  data() {\r\n    return {\r\n      city: '',\r\n      loading: false,\r\n      error: ''\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['weatherData'])\r\n  },\r\n  methods: {\r\n    async fetchWeather() {\r\n      this.error = ''\r\n      this.loading = true\r\n      try {\r\n        await this.$store.dispatch('fetchNewWeatherData', this.city)\r\n        await this.$store.dispatch('fetchWeatherData')\r\n      } catch (err) {\r\n        this.error = err.response?.data?.message || 'Errore durante il recupero dei dati meteo.'\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    formatDate(dateStr) {\r\n      if (!dateStr) return '';\r\n      const date = new Date(dateStr);\r\n      return date.toLocaleString();\r\n    },\r\n    rowStyle(item) {\r\n      // Cambia colore riga in base alla condizione meteo\r\n      if (!item.description) return {};\r\n      const desc = item.description.toLowerCase();\r\n      if (desc.includes('rain')) return { background: '#e3f0fa' };\r\n      if (desc.includes('clear')) return { background: '#fffbe6' };\r\n      if (desc.includes('cloud')) return { background: '#f0f4f7' };\r\n      if (desc.includes('snow')) return { background: '#f8fafd' };\r\n      return {};\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.weatherData.length === 0) {\r\n      this.$store.dispatch('fetchWeatherData').catch(() => {})\r\n    }\r\n  }\r\n}\r\n</script> "],"mappings":"AAyCA,SAASA,UAAS,QAAS,MAAK;AAEhC,eAAe;EACbC,IAAI,EAAE,aAAa;EACnBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,IAAI,EAAE,EAAE;MACRC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;IACT;EACF,CAAC;EACDC,QAAQ,EAAE;IACR,GAAGN,UAAU,CAAC,CAAC,aAAa,CAAC;EAC/B,CAAC;EACDO,OAAO,EAAE;IACP,MAAMC,YAAYA,CAAA,EAAG;MACnB,IAAI,CAACH,KAAI,GAAI,EAAC;MACd,IAAI,CAACD,OAAM,GAAI,IAAG;MAClB,IAAI;QACF,MAAM,IAAI,CAACK,MAAM,CAACC,QAAQ,CAAC,qBAAqB,EAAE,IAAI,CAACP,IAAI;QAC3D,MAAM,IAAI,CAACM,MAAM,CAACC,QAAQ,CAAC,kBAAkB;MAC/C,EAAE,OAAOC,GAAG,EAAE;QACZ,IAAI,CAACN,KAAI,GAAIM,GAAG,CAACC,QAAQ,EAAEV,IAAI,EAAEW,OAAM,IAAK,4CAA2C;MACzF,UAAU;QACR,IAAI,CAACT,OAAM,GAAI,KAAI;MACrB;IACF,CAAC;IACDU,UAAUA,CAACC,OAAO,EAAE;MAClB,IAAI,CAACA,OAAO,EAAE,OAAO,EAAE;MACvB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,OAAO,CAAC;MAC9B,OAAOC,IAAI,CAACE,cAAc,CAAC,CAAC;IAC9B,CAAC;IACDC,QAAQA,CAACC,IAAI,EAAE;MACb;MACA,IAAI,CAACA,IAAI,CAACC,WAAW,EAAE,OAAO,CAAC,CAAC;MAChC,MAAMC,IAAG,GAAIF,IAAI,CAACC,WAAW,CAACE,WAAW,CAAC,CAAC;MAC3C,IAAID,IAAI,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAE,OAAO;QAAEC,UAAU,EAAE;MAAU,CAAC;MAC3D,IAAIH,IAAI,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO;QAAEC,UAAU,EAAE;MAAU,CAAC;MAC5D,IAAIH,IAAI,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO;QAAEC,UAAU,EAAE;MAAU,CAAC;MAC5D,IAAIH,IAAI,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAE,OAAO;QAAEC,UAAU,EAAE;MAAU,CAAC;MAC3D,OAAO,CAAC,CAAC;IACX;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,IAAI,CAACC,WAAW,CAACC,MAAK,KAAM,CAAC,EAAE;MACjC,IAAI,CAACnB,MAAM,CAACC,QAAQ,CAAC,kBAAkB,CAAC,CAACmB,KAAK,CAAC,MAAM,CAAC,CAAC;IACzD;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}