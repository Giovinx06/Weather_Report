{"ast":null,"code":"import { createStore } from 'vuex';\nimport axios from 'axios';\n\n// API base URL\nconst API_URL = 'http://localhost:3000/api';\nexport default createStore({\n  state: {\n    status: '',\n    token: localStorage.getItem('token') || '',\n    user: JSON.parse(localStorage.getItem('user')) || {},\n    weatherData: []\n  },\n  getters: {\n    isLoggedIn: state => !!state.token,\n    authStatus: state => state.status,\n    currentUser: state => state.user,\n    isAdmin: state => state.user && state.user.role === 'admin',\n    weatherData: state => state.weatherData\n  },\n  mutations: {\n    AUTH_REQUEST(state) {\n      state.status = 'loading';\n    },\n    AUTH_SUCCESS(state, {\n      token,\n      user\n    }) {\n      state.status = 'success';\n      state.token = token;\n      state.user = user;\n    },\n    AUTH_ERROR(state) {\n      state.status = 'error';\n    },\n    LOGOUT(state) {\n      state.status = '';\n      state.token = '';\n      state.user = {};\n    },\n    SET_WEATHER_DATA(state, data) {\n      state.weatherData = data;\n    }\n  },\n  actions: {\n    // Login\n    login({\n      commit\n    }, user) {\n      return new Promise((resolve, reject) => {\n        commit('AUTH_REQUEST');\n        axios.post(`${API_URL}/auth/login`, user).then(resp => {\n          const token = resp.data.token;\n          const user = resp.data.user;\n          localStorage.setItem('token', token);\n          localStorage.setItem('user', JSON.stringify(user));\n          axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          commit('AUTH_SUCCESS', {\n            token,\n            user\n          });\n          resolve(resp);\n        }).catch(err => {\n          commit('AUTH_ERROR');\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          reject(err);\n        });\n      });\n    },\n    // Registrazione\n    register({\n      commit\n    }, user) {\n      return new Promise((resolve, reject) => {\n        commit('AUTH_REQUEST');\n        axios.post(`${API_URL}/auth/register`, user).then(resp => {\n          resolve(resp);\n        }).catch(err => {\n          commit('AUTH_ERROR');\n          reject(err);\n        });\n      });\n    },\n    // Logout\n    logout({\n      commit\n    }) {\n      return new Promise(resolve => {\n        commit('LOGOUT');\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        delete axios.defaults.headers.common['Authorization'];\n        resolve();\n      });\n    },\n    // Recupera dati meteo\n    fetchWeatherData({\n      commit\n    }) {\n      return new Promise((resolve, reject) => {\n        axios.get(`${API_URL}/data/weather`).then(resp => {\n          commit('SET_WEATHER_DATA', resp.data);\n          resolve(resp);\n        }).catch(err => {\n          reject(err);\n        });\n      });\n    },\n    // Recupera nuovi dati meteo da API esterna\n    fetchNewWeatherData(_, city) {\n      return new Promise((resolve, reject) => {\n        axios.post(`${API_URL}/data/weather/fetch`, {\n          city\n        }).then(resp => {\n          resolve(resp);\n        }).catch(err => {\n          reject(err);\n        });\n      });\n    }\n  }\n});","map":{"version":3,"names":["createStore","axios","API_URL","state","status","token","localStorage","getItem","user","JSON","parse","weatherData","getters","isLoggedIn","authStatus","currentUser","isAdmin","role","mutations","AUTH_REQUEST","AUTH_SUCCESS","AUTH_ERROR","LOGOUT","SET_WEATHER_DATA","data","actions","login","commit","Promise","resolve","reject","post","then","resp","setItem","stringify","defaults","headers","common","catch","err","removeItem","register","logout","fetchWeatherData","get","fetchNewWeatherData","_","city"],"sources":["C:/Programmazione/Wheater_Report/progetto/frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\r\nimport axios from 'axios'\r\n\r\n// API base URL\r\nconst API_URL = 'http://localhost:3000/api'\r\n\r\nexport default createStore({\r\n  state: {\r\n    status: '',\r\n    token: localStorage.getItem('token') || '',\r\n    user: JSON.parse(localStorage.getItem('user')) || {},\r\n    weatherData: []\r\n  },\r\n  getters: {\r\n    isLoggedIn: state => !!state.token,\r\n    authStatus: state => state.status,\r\n    currentUser: state => state.user,\r\n    isAdmin: state => state.user && state.user.role === 'admin',\r\n    weatherData: state => state.weatherData\r\n  },\r\n  mutations: {\r\n    AUTH_REQUEST(state) {\r\n      state.status = 'loading'\r\n    },\r\n    AUTH_SUCCESS(state, { token, user }) {\r\n      state.status = 'success'\r\n      state.token = token\r\n      state.user = user\r\n    },\r\n    AUTH_ERROR(state) {\r\n      state.status = 'error'\r\n    },\r\n    LOGOUT(state) {\r\n      state.status = ''\r\n      state.token = ''\r\n      state.user = {}\r\n    },\r\n    SET_WEATHER_DATA(state, data) {\r\n      state.weatherData = data\r\n    }\r\n  },\r\n  actions: {\r\n    // Login\r\n    login({ commit }, user) {\r\n      return new Promise((resolve, reject) => {\r\n        commit('AUTH_REQUEST')\r\n        axios.post(`${API_URL}/auth/login`, user)\r\n          .then(resp => {\r\n            const token = resp.data.token\r\n            const user = resp.data.user\r\n            localStorage.setItem('token', token)\r\n            localStorage.setItem('user', JSON.stringify(user))\r\n            axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n            commit('AUTH_SUCCESS', { token, user })\r\n            resolve(resp)\r\n          })\r\n          .catch(err => {\r\n            commit('AUTH_ERROR')\r\n            localStorage.removeItem('token')\r\n            localStorage.removeItem('user')\r\n            reject(err)\r\n          })\r\n      })\r\n    },\r\n    \r\n    // Registrazione\r\n    register({ commit }, user) {\r\n      return new Promise((resolve, reject) => {\r\n        commit('AUTH_REQUEST')\r\n        axios.post(`${API_URL}/auth/register`, user)\r\n          .then(resp => {\r\n            resolve(resp)\r\n          })\r\n          .catch(err => {\r\n            commit('AUTH_ERROR')\r\n            reject(err)\r\n          })\r\n      })\r\n    },\r\n    \r\n    // Logout\r\n    logout({ commit }) {\r\n      return new Promise((resolve) => {\r\n        commit('LOGOUT')\r\n        localStorage.removeItem('token')\r\n        localStorage.removeItem('user')\r\n        delete axios.defaults.headers.common['Authorization']\r\n        resolve()\r\n      })\r\n    },\r\n    \r\n    // Recupera dati meteo\r\n    fetchWeatherData({ commit }) {\r\n      return new Promise((resolve, reject) => {\r\n        axios.get(`${API_URL}/data/weather`)\r\n          .then(resp => {\r\n            commit('SET_WEATHER_DATA', resp.data)\r\n            resolve(resp)\r\n          })\r\n          .catch(err => {\r\n            reject(err)\r\n          })\r\n      })\r\n    },\r\n    \r\n    // Recupera nuovi dati meteo da API esterna\r\n    fetchNewWeatherData(_, city) {\r\n      return new Promise((resolve, reject) => {\r\n        axios.post(`${API_URL}/data/weather/fetch`, { city })\r\n          .then(resp => {\r\n            resolve(resp)\r\n          })\r\n          .catch(err => {\r\n            reject(err)\r\n          })\r\n      })\r\n    }\r\n  }\r\n}) "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}