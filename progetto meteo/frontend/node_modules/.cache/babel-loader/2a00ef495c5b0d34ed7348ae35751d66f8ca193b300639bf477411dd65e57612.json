{"ast":null,"code":"import { mapGetters } from 'vuex';\nexport default {\n  name: \"WeatherView\",\n  data() {\n    return {\n      city: '',\n      loading: false,\n      error: ''\n    };\n  },\n  computed: {\n    ...mapGetters(['weatherData'])\n  },\n  methods: {\n    async fetchWeather() {\n      this.error = '';\n      this.loading = true;\n      try {\n        await this.$store.dispatch('fetchNewWeatherData', this.city);\n        await this.$store.dispatch('fetchWeatherData');\n      } catch (err) {\n        this.error = err.response?.data?.message || 'Errore durante il recupero dei dati meteo.';\n      } finally {\n        this.loading = false;\n      }\n    },\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      return date.toLocaleString();\n    },\n    rowClass(item) {\n      if (!item || !item.description) return '';\n      const desc = item.description.toLowerCase();\n      if (desc.includes('pioggia') || desc.includes('rain')) return 'weather-rain';\n      if (desc.includes('sereno') || desc.includes('clear') || desc.includes('sun')) return 'weather-clear';\n      if (desc.includes('nuvol') || desc.includes('cloud')) return 'weather-cloud';\n      if (desc.includes('neve') || desc.includes('snow')) return 'weather-snow';\n      if (desc.includes('temporale') || desc.includes('storm') || desc.includes('thunder')) return 'weather-storm';\n      if (desc.includes('nebbia') || desc.includes('fog')) return 'weather-fog';\n      return '';\n    },\n    weatherIconClass(item) {\n      if (!item || !item.description) return 'fas fa-cloud fa-lg text-secondary';\n      const desc = item.description.toLowerCase();\n      if (desc.includes('pioggia') || desc.includes('rain')) return 'fas fa-cloud-rain fa-lg text-info';\n      if (desc.includes('sereno') || desc.includes('clear') || desc.includes('sun')) return 'fas fa-sun fa-lg text-warning';\n      if (desc.includes('nuvol') || desc.includes('cloud')) return 'fas fa-cloud fa-lg text-secondary';\n      if (desc.includes('neve') || desc.includes('snow')) return 'fas fa-snowflake fa-lg text-info';\n      if (desc.includes('temporale') || desc.includes('storm') || desc.includes('thunder')) return 'fas fa-bolt fa-lg text-warning';\n      if (desc.includes('nebbia') || desc.includes('fog')) return 'fas fa-smog fa-lg text-secondary';\n      if (desc.includes('vento') || desc.includes('wind')) return 'fas fa-wind fa-lg text-info';\n      return 'fas fa-cloud fa-lg text-secondary';\n    },\n    getWeatherIconUrl(icon) {\n      // Se l'icona è già un URL completo, usala\n      if (icon && icon.startsWith('http')) {\n        return icon;\n      }\n      // Se l'icona è un codice OpenWeatherMap (es. \"01d.png\" o \"01d\")\n      else if (icon) {\n        // Se l'icona contiene già .png, usa il formato corretto\n        if (icon.includes('.png')) {\n          return `https://openweathermap.org/img/wn/${icon.replace('.png', '')}@2x.png`;\n        }\n        // Altrimenti aggiungi @2x.png\n        return `https://openweathermap.org/img/wn/${icon}@2x.png`;\n      }\n      // Fallback su un'icona generica se manca l'icona\n      return null;\n    }\n  },\n  mounted() {\n    if (this.weatherData.length === 0) {\n      this.$store.dispatch('fetchWeatherData').catch(() => {});\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","name","data","city","loading","error","computed","methods","fetchWeather","$store","dispatch","err","response","message","formatDate","dateStr","date","Date","toLocaleString","rowClass","item","description","desc","toLowerCase","includes","weatherIconClass","getWeatherIconUrl","icon","startsWith","replace","mounted","weatherData","length","catch"],"sources":["C:\\Users\\Giovanni\\OneDrive\\Desktop\\Scuola\\TPI\\progetto meteo\\frontend\\src\\views\\WeatherView.vue"],"sourcesContent":["<template>\r\n  <div class=\"weather-view\">\r\n    <div class=\"container py-4\">\r\n      <!-- Header -->\r\n      <div class=\"mb-4\">\r\n        <h1 class=\"display-5 fw-bold text-primary mb-1\">\r\n          <i class=\"fas fa-cloud-sun me-2\"></i> Meteo\r\n        </h1>\r\n        <p class=\"lead text-muted\">Consulta le previsioni meteo in tempo reale per qualsiasi città</p>\r\n      </div>\r\n      \r\n      <!-- Search Card -->\r\n      <div class=\"card border-0 shadow-sm mb-4\">\r\n        <div class=\"card-body p-4\">\r\n          <form class=\"row g-3\" @submit.prevent=\"fetchWeather\">\r\n            <div class=\"col-md-8 col-lg-6\">\r\n              <div class=\"input-group input-group-lg\">\r\n                <span class=\"input-group-text bg-white border-end-0\">\r\n                  <i class=\"fas fa-search text-primary\"></i>\r\n                </span>\r\n                <input \r\n                  v-model=\"city\" \r\n                  type=\"text\" \r\n                  class=\"form-control border-start-0 ps-0\" \r\n                  placeholder=\"Inserisci una città...\" \r\n                  required \r\n                />\r\n              </div>\r\n            </div>\r\n            <div class=\"col-auto\">\r\n              <button type=\"submit\" class=\"btn btn-primary btn-lg px-4\" :disabled=\"loading\">\r\n                <span v-if=\"loading\" class=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>\r\n                {{ loading ? 'Cercando...' : 'Cerca' }}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Alerts -->\r\n      <div v-if=\"error\" class=\"alert alert-danger border-0 shadow-sm d-flex align-items-center\" role=\"alert\">\r\n        <i class=\"fas fa-exclamation-circle me-3 fs-4\"></i>\r\n        <div>{{ error }}</div>\r\n      </div>\r\n      \r\n      <div v-if=\"loading && !error\" class=\"alert alert-info border-0 shadow-sm d-flex align-items-center\" role=\"alert\">\r\n        <i class=\"fas fa-spinner fa-spin me-3 fs-4\"></i>\r\n        <div>Caricamento delle informazioni meteo...</div>\r\n      </div>\r\n      \r\n      <div v-if=\"weatherData.length === 0 && !loading && !error\" class=\"alert alert-secondary border-0 shadow-sm d-flex align-items-center\" role=\"alert\">\r\n        <i class=\"fas fa-info-circle me-3 fs-4\"></i>\r\n        <div>Nessun dato meteo disponibile. Cerca una città per visualizzare i dati.</div>\r\n      </div>\r\n      \r\n      <!-- Weather Results -->\r\n      <div v-if=\"weatherData.length > 0\" class=\"card border-0 shadow-sm\">\r\n        <div class=\"card-header bg-white d-flex align-items-center py-3\">\r\n          <i class=\"fas fa-history text-primary me-2 fs-4\"></i>\r\n          <h5 class=\"mb-0\">Ricerche meteo recenti</h5>\r\n        </div>\r\n        <div class=\"card-body p-0\">\r\n          <div class=\"table-responsive\">\r\n            <table class=\"table table-hover align-middle mb-0 weather-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Città</th>\r\n                  <th>Temperatura</th>\r\n                  <th>Condizione</th>\r\n                  <th>Data ricerca</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr v-for=\"(item, idx) in weatherData\" :key=\"idx\" :class=\"rowClass(item)\">\r\n                  <td class=\"ps-3\">\r\n                    <i class=\"fas fa-map-marker-alt me-2 text-primary\"></i>\r\n                    <span class=\"fw-medium\">{{ item.city }}</span>, \r\n                    <span class=\"text-muted small\">{{ item.country }}</span>\r\n                  </td>\r\n                  <td>\r\n                    <span class=\"fs-5 fw-bold\">{{ item.temperature }}°C</span>\r\n                    <span class=\"ms-2 text-muted small\" v-if=\"item.humidity\">\r\n                      <i class=\"fas fa-tint me-1\"></i>{{ item.humidity }}%\r\n                    </span>\r\n                  </td>\r\n                  <td>\r\n                    <div class=\"d-flex align-items-center\">\r\n                      <div class=\"me-2\">\r\n                        <i :class=\"weatherIconClass(item)\" style=\"font-size: 24px; width: 40px; text-align: center;\"></i>\r\n                      </div>\r\n                      <span>{{ item.description }}</span>\r\n                    </div>\r\n                  </td>\r\n                  <td>{{ formatDate(item.fetchDate || item.createdAt || item.date) }}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  name: \"WeatherView\",\r\n  data() {\r\n    return {\r\n      city: '',\r\n      loading: false,\r\n      error: ''\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['weatherData'])\r\n  },\r\n  methods: {\r\n    async fetchWeather() {\r\n      this.error = ''\r\n      this.loading = true\r\n      try {\r\n        await this.$store.dispatch('fetchNewWeatherData', this.city)\r\n        await this.$store.dispatch('fetchWeatherData')\r\n      } catch (err) {\r\n        this.error = err.response?.data?.message || 'Errore durante il recupero dei dati meteo.'\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    formatDate(dateStr) {\r\n      if (!dateStr) return '';\r\n      const date = new Date(dateStr);\r\n      return date.toLocaleString();\r\n    },\r\n    rowClass(item) {\r\n      if (!item || !item.description) return '';\r\n      const desc = item.description.toLowerCase();\r\n      \r\n      if (desc.includes('pioggia') || desc.includes('rain')) return 'weather-rain';\r\n      if (desc.includes('sereno') || desc.includes('clear') || desc.includes('sun')) return 'weather-clear';\r\n      if (desc.includes('nuvol') || desc.includes('cloud')) return 'weather-cloud';\r\n      if (desc.includes('neve') || desc.includes('snow')) return 'weather-snow';\r\n      if (desc.includes('temporale') || desc.includes('storm') || desc.includes('thunder')) return 'weather-storm';\r\n      if (desc.includes('nebbia') || desc.includes('fog')) return 'weather-fog';\r\n      \r\n      return '';\r\n    },\r\n    weatherIconClass(item) {\r\n      if (!item || !item.description) return 'fas fa-cloud fa-lg text-secondary';\r\n      const desc = item.description.toLowerCase();\r\n      \r\n      if (desc.includes('pioggia') || desc.includes('rain')) return 'fas fa-cloud-rain fa-lg text-info';\r\n      if (desc.includes('sereno') || desc.includes('clear') || desc.includes('sun')) return 'fas fa-sun fa-lg text-warning';\r\n      if (desc.includes('nuvol') || desc.includes('cloud')) return 'fas fa-cloud fa-lg text-secondary';\r\n      if (desc.includes('neve') || desc.includes('snow')) return 'fas fa-snowflake fa-lg text-info';\r\n      if (desc.includes('temporale') || desc.includes('storm') || desc.includes('thunder')) return 'fas fa-bolt fa-lg text-warning';\r\n      if (desc.includes('nebbia') || desc.includes('fog')) return 'fas fa-smog fa-lg text-secondary';\r\n      if (desc.includes('vento') || desc.includes('wind')) return 'fas fa-wind fa-lg text-info';\r\n      \r\n      return 'fas fa-cloud fa-lg text-secondary';\r\n    },\r\n    getWeatherIconUrl(icon) {\r\n      // Se l'icona è già un URL completo, usala\r\n      if (icon && icon.startsWith('http')) {\r\n        return icon;\r\n      }\r\n      // Se l'icona è un codice OpenWeatherMap (es. \"01d.png\" o \"01d\")\r\n      else if (icon) {\r\n        // Se l'icona contiene già .png, usa il formato corretto\r\n        if (icon.includes('.png')) {\r\n          return `https://openweathermap.org/img/wn/${icon.replace('.png', '')}@2x.png`;\r\n        }\r\n        // Altrimenti aggiungi @2x.png\r\n        return `https://openweathermap.org/img/wn/${icon}@2x.png`;\r\n      }\r\n      // Fallback su un'icona generica se manca l'icona\r\n      return null;\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.weatherData.length === 0) {\r\n      this.$store.dispatch('fetchWeatherData').catch(() => {})\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.weather-view {\r\n  min-height: 70vh;\r\n}\r\n\r\n.card {\r\n  border-radius: 0.75rem;\r\n  overflow: hidden;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.input-group-text {\r\n  border-top-left-radius: 0.5rem;\r\n  border-bottom-left-radius: 0.5rem;\r\n}\r\n\r\n.form-control {\r\n  border-top-right-radius: 0.5rem;\r\n  border-bottom-right-radius: 0.5rem;\r\n}\r\n\r\n.weather-icon {\r\n  width: 40px;\r\n  height: 40px;\r\n}\r\n\r\n.weather-table th {\r\n  font-weight: 600;\r\n  border-top: none;\r\n  border-bottom-width: 1px;\r\n  padding-left: 1.5rem;\r\n  padding-right: 1.5rem;\r\n}\r\n\r\n.weather-table td {\r\n  padding: 1rem 1.5rem;\r\n}\r\n\r\n/* Classi per le righe della tabella in base alle condizioni meteo */\r\n.weather-rain {\r\n  background-color: rgba(227, 242, 253, 0.4);\r\n}\r\n\r\n.weather-clear {\r\n  background-color: rgba(255, 248, 225, 0.4);\r\n}\r\n\r\n.weather-cloud {\r\n  background-color: rgba(236, 239, 241, 0.4);\r\n}\r\n\r\n.weather-snow {\r\n  background-color: rgba(237, 247, 251, 0.4);\r\n}\r\n\r\n.weather-storm {\r\n  background-color: rgba(232, 234, 246, 0.4);\r\n}\r\n\r\n/* Responsive tweaks */\r\n@media (max-width: 767.98px) {\r\n  .display-5 {\r\n    font-size: 1.75rem;\r\n  }\r\n  \r\n  .lead {\r\n    font-size: 1rem;\r\n  }\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}